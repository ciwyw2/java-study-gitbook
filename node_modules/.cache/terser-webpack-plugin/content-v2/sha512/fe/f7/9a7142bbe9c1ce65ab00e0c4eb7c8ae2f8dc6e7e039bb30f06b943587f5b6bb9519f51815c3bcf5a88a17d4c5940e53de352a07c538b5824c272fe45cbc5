{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{1312:function(a,t,e){\"use strict\";e.r(t);var s=e(42),n=Object(s.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":a.$parent.slotKey}},[s(\"h1\",{attrs:{id:\"skywalking分布式追踪\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#skywalking分布式追踪\"}},[a._v(\"#\")]),a._v(\" skywalking分布式追踪\")]),a._v(\" \"),s(\"h2\",{attrs:{id:\"_1-简介\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-简介\"}},[a._v(\"#\")]),a._v(\" 1. 简介\")]),a._v(\" \"),s(\"p\",[a._v(\"skywalking 主要包括了分布式追踪、性能指标分析、应用和服务依赖分析等功能，使用体验后感觉比zipkin更为直观，是替代zipkin的一个不错的选择\")]),a._v(\" \"),s(\"h2\",{attrs:{id:\"_2-架构\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-架构\"}},[a._v(\"#\")]),a._v(\" 2. 架构\")]),a._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:e(749),alt:\"image-20200129144042400\"}})]),a._v(\" \"),s(\"p\",[a._v(\"从上图可以看出skywalking主要分为四个模块：agent、collector、webapp-ui和storage。\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[s(\"p\",[a._v(\"agent：\")]),a._v(\" \"),s(\"p\",[a._v(\"Skywalking agent探针无侵入地接入Spring Cloud应用\")])]),a._v(\" \"),s(\"li\",[s(\"p\",[a._v(\"collector\")]),a._v(\" \"),s(\"p\",[a._v(\"通过HTTP或者GRPC将应用数据采集到collector收集器\")])]),a._v(\" \"),s(\"li\",[s(\"p\",[a._v(\"storage\")]),a._v(\" \"),s(\"p\",[a._v(\"collector中的数据存储与storage，支持MySQL、H2、Elasticsearch等存储\")])]),a._v(\" \"),s(\"li\",[s(\"p\",[a._v(\"webapp-ui\")]),a._v(\" \"),s(\"p\",[a._v(\"最终这些数据集中在webapp-ui以图形化的方式呈现\")])])]),a._v(\" \"),s(\"h2\",{attrs:{id:\"_3-搭建skywalking\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-搭建skywalking\"}},[a._v(\"#\")]),a._v(\" 3. 搭建skywalking\")]),a._v(\" \"),s(\"p\",[a._v(\"我们使用Docker Compose 搭建Skywalking，数据存储我们选择性能更高的Elasticsearch。\")]),a._v(\" \"),s(\"h3\",{attrs:{id:\"_3-1-docker-compose-yml\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-1-docker-compose-yml\"}},[a._v(\"#\")]),a._v(\" 3.1 docker-compose.yml\")]),a._v(\" \"),s(\"p\",[a._v(\"完整的docker-compose.yml如下\")]),a._v(\" \"),s(\"div\",{staticClass:\"language-dockerfile extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-dockerfile\"}},[s(\"code\",[a._v(\"version\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"'3'\")]),a._v(\"\\n\\nservices\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n  elasticsearch\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n    image\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" elasticsearch\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"6.4.1\\n    container_name\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" elasticsearch\\n    restart\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" always\\n    environment\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" cluster.name=elasticsearch\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" xpack.security.enabled=false\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"ES_JAVA_OPTS=-Xms216m -Xmx216m\"')]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" node.name=elasticsearch_node_1\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"TZ=Asia/Shanghai\"')]),a._v(\"\\n    volumes\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" /elk/elasticsearch/data\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"/usr/share/elasticsearch/data\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" /elk/elasticsearch/logs\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"/usr/share/elasticsearch/logs\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" /elk/elasticsearch/elasticsearch.yml\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"/usr/share/elasticsearch/config/elasticsearch.yml\\n    ports\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" 9200\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"9200\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" 9300\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"9300\\n\\n  skywalking\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"oap\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n    image\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" apache/skywalking\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"oap\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"server\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"6.4.0\\n    container_name\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" skywalking\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"oap\\n    depends_on\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" elasticsearch\\n    links\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" elasticsearch\\n    restart\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" always\\n    ports\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" 11800\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"11800\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" 12800\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"12800\\n    environment\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"TZ=Asia/Shanghai\"')]),a._v(\"\\n    volumes\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" /elk/skywalking/config\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"/apache\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"skywalking\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"apm\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"bin/config\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"ro\\n\\n  skywalking\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"ui\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n    image\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" apache/skywalking\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"ui\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"6.4.0\\n    container_name\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" skywalking\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"ui\\n    depends_on\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" skywalking\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"oap\\n    links\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" skywalking\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"oap\\n    restart\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" always\\n    ports\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" 8090\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"8080\\n    environment\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"collector.ribbon.listOfServers=skywalking-oap:12800\"')]),a._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"TZ=Asia/Shanghai\"')]),a._v(\"\\n\")])])]),s(\"p\",[a._v(\"上面部署了三个容器：Elasticsearch、skywalking-oap（即collector）和skywalking-ui（即webapp-ui）。\")]),a._v(\" \"),s(\"h3\",{attrs:{id:\"_3-2-创建挂载目录和配置文件\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-2-创建挂载目录和配置文件\"}},[a._v(\"#\")]),a._v(\" 3.2 创建挂载目录和配置文件\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v(\"# 创建Elasticsearch的挂载目录\\nmkdir -p /elk/elasticsearch/data /elk/elasticsearch/logs\\n\\n# 创建Elasticsearch的配置文件elasticsearch.yml\\nvim /elk/elasticsearch/elasticsearch.yml\\n\")])])]),s(\"h3\",{attrs:{id:\"_3-3-编辑-elasticsearch-yml\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-3-编辑-elasticsearch-yml\"}},[a._v(\"#\")]),a._v(\" 3.3 编辑 elasticsearch.yml\")]),a._v(\" \"),s(\"p\",[a._v(\"配置文件elasticsearch.yml内容如下所示：\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v('http.host: 0.0.0.0\\nhttp.cors.enabled: true\\nhttp.cors.allow-origin: \"*\"\\ntransport.host: 0.0.0.0\\n')])])]),s(\"h3\",{attrs:{id:\"_3-4-授权\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-4-授权\"}},[a._v(\"#\")]),a._v(\" 3.4 授权\")]),a._v(\" \"),s(\"p\",[a._v(\"对Elasticsearch的挂载目录授予最高权限：\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v(\"chmod 777 -R /elk/elasticsearch\\n\")])])]),s(\"h3\",{attrs:{id:\"_3-5-创建skywalking-oap的挂载目录和配置文件\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-5-创建skywalking-oap的挂载目录和配置文件\"}},[a._v(\"#\")]),a._v(\" 3.5 创建skywalking-oap的挂载目录和配置文件\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v(\"# 创建skywalking-oap的挂载目录\\nmkdir -p /elk/skywalking/config\\n\\n# 创建skywalking-oap的配置文件skywalking.yml\\ntouch /elk/skywalking/config/skywalking.yml\\n\")])])]),s(\"p\",[a._v(\"skywalking.yml内容如下所示：\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v('# Licensed to the Apache Software Foundation (ASF) under one\\n# or more contributor license agreements.  See the NOTICE file\\n# distributed with this work for additional information\\n# regarding copyright ownership.  The ASF licenses this file\\n# to you under the Apache License, Version 2.0 (the\\n# \"License\"); you may not use this file except in compliance\\n# with the License.  You may obtain a copy of the License at\\n#\\n#     http://www.apache.org/licenses/LICENSE-2.0\\n#\\n# Unless required by applicable law or agreed to in writing, software\\n# distributed under the License is distributed on an \"AS IS\" BASIS,\\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n# See the License for the specific language governing permissions and\\n# limitations under the License.\\n\\ncluster:\\n  standalone:\\n  # Please check your ZooKeeper is 3.5+, However, it is also compatible with ZooKeeper 3.4.x. Replace the ZooKeeper 3.5+\\n  # library the oap-libs folder with your ZooKeeper 3.4.x library.\\n#  zookeeper:\\n#    nameSpace: ${SW_NAMESPACE:\"\"}\\n#    hostPort: ${SW_CLUSTER_ZK_HOST_PORT:localhost:2181}\\n#    #Retry Policy\\n#    baseSleepTimeMs: ${SW_CLUSTER_ZK_SLEEP_TIME:1000} # initial amount of time to wait between retries\\n#    maxRetries: ${SW_CLUSTER_ZK_MAX_RETRIES:3} # max number of times to retry\\n#  kubernetes:\\n#    watchTimeoutSeconds: ${SW_CLUSTER_K8S_WATCH_TIMEOUT:60}\\n#    namespace: ${SW_CLUSTER_K8S_NAMESPACE:default}\\n#    labelSelector: ${SW_CLUSTER_K8S_LABEL:app=collector,release=skywalking}\\n#    uidEnvName: ${SW_CLUSTER_K8S_UID:SKYWALKING_COLLECTOR_UID}\\n#  consul:\\n#    serviceName: ${SW_SERVICE_NAME:\"SkyWalking_OAP_Cluster\"}\\n#     Consul cluster nodes, example: 10.0.0.1:8500,10.0.0.2:8500,10.0.0.3:8500\\n#    hostPort: ${SW_CLUSTER_CONSUL_HOST_PORT:localhost:8500}\\ncore:\\n  default:\\n    # Mixed: Receive agent data, Level 1 aggregate, Level 2 aggregate\\n    # Aggregator: Level 2 aggregate\\n    role: ${SW_CORE_ROLE:Mixed} # Mixed/Receiver/Aggregator\\n    restHost: ${SW_CORE_REST_HOST:0.0.0.0}\\n    restPort: ${SW_CORE_REST_PORT:12800}\\n    restContextPath: ${SW_CORE_REST_CONTEXT_PATH:/}\\n    gRPCHost: ${SW_CORE_GRPC_HOST:0.0.0.0}\\n    gRPCPort: ${SW_CORE_GRPC_PORT:11800}\\n    downsampling:\\n      - Hour\\n      - Day\\n      - Month\\n    # Set a timeout on metric data. After the timeout has expired, the metric data will automatically be deleted.\\n    recordDataTTL: ${SW_CORE_RECORD_DATA_TTL:90} # Unit is minute\\n    minuteMetricsDataTTL: ${SW_CORE_MINUTE_METRIC_DATA_TTL:90} # Unit is minute\\n    hourMetricsDataTTL: ${SW_CORE_HOUR_METRIC_DATA_TTL:36} # Unit is hour\\n    dayMetricsDataTTL: ${SW_CORE_DAY_METRIC_DATA_TTL:45} # Unit is day\\n    monthMetricsDataTTL: ${SW_CORE_MONTH_METRIC_DATA_TTL:18} # Unit is month\\nstorage:\\n  elasticsearch:\\n    # set the namespace in elasticsearch\\n    clusterNodes: ${SW_STORAGE_ES_CLUSTER_NODES:elasticsearch:9200}\\n    indexShardsNumber: ${SW_STORAGE_ES_INDEX_SHARDS_NUMBER:2}\\n    indexReplicasNumber: ${SW_STORAGE_ES_INDEX_REPLICAS_NUMBER:0}\\n    # Batch process setting, refer to https://www.elastic.co/guide/en/elasticsearch/client/java-api/5.5/java-docs-bulk-processor.html\\n    bulkActions: ${SW_STORAGE_ES_BULK_ACTIONS:2000} # Execute the bulk every 2000 requests\\n    bulkSize: ${SW_STORAGE_ES_BULK_SIZE:20} # flush the bulk every 20mb\\n    flushInterval: ${SW_STORAGE_ES_FLUSH_INTERVAL:10} # flush the bulk every 10 seconds whatever the number of requests\\n    concurrentRequests: ${SW_STORAGE_ES_CONCURRENT_REQUESTS:2} # the number of concurrent requests\\n    metadataQueryMaxSize: ${SW_STORAGE_ES_QUERY_MAX_SIZE:5000}\\n    segmentQueryMaxSize: ${SW_STORAGE_ES_QUERY_SEGMENT_SIZE:200}\\n#  h2:\\n#    driver: ${SW_STORAGE_H2_DRIVER:org.h2.jdbcx.JdbcDataSource}\\n#    url: ${SW_STORAGE_H2_URL:jdbc:h2:mem:skywalking-oap-db}\\n#    user: ${SW_STORAGE_H2_USER:sa}\\n#    metadataQueryMaxSize: ${SW_STORAGE_H2_QUERY_MAX_SIZE:5000}\\n#  mysql:\\n#    metadataQueryMaxSize: ${SW_STORAGE_H2_QUERY_MAX_SIZE:5000}\\nreceiver-sharing-server:\\n  default:\\nreceiver-register:\\n  default:\\nreceiver-trace:\\n  default:\\n    bufferPath: ${SW_RECEIVER_BUFFER_PATH:../trace-buffer/}  # Path to trace buffer files, suggest to use absolute path\\n    bufferOffsetMaxFileSize: ${SW_RECEIVER_BUFFER_OFFSET_MAX_FILE_SIZE:100} # Unit is MB\\n    bufferDataMaxFileSize: ${SW_RECEIVER_BUFFER_DATA_MAX_FILE_SIZE:500} # Unit is MB\\n    bufferFileCleanWhenRestart: ${SW_RECEIVER_BUFFER_FILE_CLEAN_WHEN_RESTART:false}\\n    sampleRate: ${SW_TRACE_SAMPLE_RATE:10000} # The sample rate precision is 1/10000. 10000 means 100% sample in default.\\n    slowDBAccessThreshold: ${SW_SLOW_DB_THRESHOLD:default:200,mongodb:100} # The slow database access thresholds. Unit ms.\\nreceiver-jvm:\\n  default:\\nservice-mesh:\\n  default:\\n    bufferPath: ${SW_SERVICE_MESH_BUFFER_PATH:../mesh-buffer/}  # Path to trace buffer files, suggest to use absolute path\\n    bufferOffsetMaxFileSize: ${SW_SERVICE_MESH_OFFSET_MAX_FILE_SIZE:100} # Unit is MB\\n    bufferDataMaxFileSize: ${SW_SERVICE_MESH_BUFFER_DATA_MAX_FILE_SIZE:500} # Unit is MB\\n    bufferFileCleanWhenRestart: ${SW_SERVICE_MESH_BUFFER_FILE_CLEAN_WHEN_RESTART:false}\\nistio-telemetry:\\n  default:\\nenvoy-metric:\\n  default:\\n# receiver_zipkin:\\n#   default:\\n#     host: ${SW_RECEIVER_ZIPKIN_HOST:0.0.0.0}\\n#     port: ${SW_RECEIVER_ZIPKIN_PORT:9411}\\n#     contextPath: ${SW_RECEIVER_ZIPKIN_CONTEXT_PATH:/}\\nquery:\\n  graphql:\\n    path: ${SW_QUERY_GRAPHQL_PATH:/graphql}\\nalarm:\\n  default:\\ntelemetry:\\n  none:\\n')])])]),s(\"p\",[a._v(\"上面配置中，\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[a._v(\"存储选择了Elasticsearch代替默认的H2，其他配置均为skywalking-oap的默认配置。\")]),a._v(\" \"),s(\"li\",[a._v(\"Skywalking的UI。默认是8080端口。和我应用端口冲突了，我改成8090\")])]),a._v(\" \"),s(\"p\",[a._v(\"上面docker-compose.yml中我们通过\"),s(\"code\",[a._v(\"TZ=Asia/Shanghai\")]),a._v(\"设置了时区，如果不指定时区的话默认是UTC时区，你会看到收集到的数据会比实际早8个小时。\")]),a._v(\" \"),s(\"h3\",{attrs:{id:\"_3-6-设置内存权限\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-6-设置内存权限\"}},[a._v(\"#\")]),a._v(\" 3.6 设置内存权限\")]),a._v(\" \"),s(\"p\",[a._v(\"在启动之前我们还需要通过\"),s(\"code\",[a._v(\"sysctl -w vm.max_map_count=262144\")]),a._v(\"命令设置内存权限，\"),s(\"code\",[a._v(\"262144\")]),a._v(\"是构建Elasticsearch的最小内存。\")]),a._v(\" \"),s(\"h3\",{attrs:{id:\"_3-7-启动容器\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-7-启动容器\"}},[a._v(\"#\")]),a._v(\" 3.7 启动容器\")]),a._v(\" \"),s(\"p\",[a._v(\"在目录/elk/DockerCompos， 使用\"),s(\"code\",[a._v(\"docker-compose up -d\")]),a._v(\"启动这几个容器：\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"_3-8-查看-elasticsearch\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-8-查看-elasticsearch\"}},[a._v(\"#\")]),a._v(\" 3.8 查看 Elasticsearch\")]),a._v(\" \"),s(\"p\",[a._v(\"稍等片刻后，在浏览器访问 \"),s(\"a\",{attrs:{href:\"http://120.79.200.111:9200/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a._v(\"http://120.79.200.111:9200/\"),s(\"OutboundLink\")],1),a._v(\" 地址，如下所示表示Elasticsearch已经启动成功：\")]),a._v(\" \"),s(\"h3\",{attrs:{id:\"_3-9-访问-skywalking的ui\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-9-访问-skywalking的ui\"}},[a._v(\"#\")]),a._v(\" 3.9 访问 Skywalking的UI\")]),a._v(\" \"),s(\"p\",[a._v(\"访问Skywalking的UI界面：http://120.79.200.111:8090/\")]),a._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:e(750),alt:\"image-20200129174550557\"}})]),a._v(\" \"),s(\"p\",[a._v(\"因为还没有整合agent所以现在还没有数据，界面是空的。\")])])}),[],!1,null,null,null);t.default=n.exports},749:function(a,t,e){a.exports=e.p+\"assets/img/image-20200129144042400.88aff062.png\"},750:function(a,t,e){a.exports=e.p+\"assets/img/image-20200129174550557.8872c9c1.png\"}}]);","extractedComments":[]}