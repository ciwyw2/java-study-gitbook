{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[412],{958:function(a,t,s){\"use strict\";s.r(t);var r=s(42),e=Object(r.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":a.$parent.slotKey}},[s(\"h1\",{attrs:{id:\"事务\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#事务\"}},[a._v(\"#\")]),a._v(\" 事务\")]),a._v(\" \"),s(\"p\",[a._v(\"事务处理（transaction processing）：通过确保成批的SQL 操作\"),s(\"strong\",[a._v(\"要么完全执行，要么完全不执行，来维护数据库的完整性\")])]),a._v(\" \"),s(\"h3\",{attrs:{id:\"_1-1-术语\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-1-术语\"}},[a._v(\"#\")]),a._v(\" 1.1 术语\")]),a._v(\" \"),s(\"ul\",[s(\"li\",[s(\"p\",[a._v(\"事务(transaction)：\")]),a._v(\" \"),s(\"p\",[a._v(\"指一组SQL语句\")])]),a._v(\" \"),s(\"li\",[s(\"p\",[a._v(\"回退（rollback）\")]),a._v(\" \"),s(\"p\",[a._v(\"撤销指定SQL语句的过程\")])]),a._v(\" \"),s(\"li\",[s(\"p\",[a._v(\"提交（commit）\")]),a._v(\" \"),s(\"p\",[a._v(\"将未存储的SQL语句结果写入数据库表\")])]),a._v(\" \"),s(\"li\",[s(\"p\",[a._v(\"保留点（savepoint）\")]),a._v(\" \"),s(\"p\",[a._v(\"事务处理中设置的临时占位符（placeholder），可以对他发布回退（与回退整个事务不同）\")])])]),a._v(\" \"),s(\"h2\",{attrs:{id:\"_2-事务操作实例\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-事务操作实例\"}},[a._v(\"#\")]),a._v(\" 2. 事务操作实例\")]),a._v(\" \"),s(\"h3\",{attrs:{id:\"_2-1-sql-server\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-1-sql-server\"}},[a._v(\"#\")]),a._v(\" 2.1 SQL Server\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v(\"BEGIN TRANSATION\\n...\\nCOMMIT TRANSACTION\\n\")])])]),s(\"p\",[a._v(\"BEGIN TRANSATION 和 COMMIT TRANSACTION 语句之间的SQL 必须完全执行或者完全不执行\")]),a._v(\" \"),s(\"h3\",{attrs:{id:\"_2-2-mysql\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-2-mysql\"}},[a._v(\"#\")]),a._v(\" 2.2 MySQL\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v(\"START TRANSACTION \\n...\\n\")])])]),s(\"h3\",{attrs:{id:\"_2-3-oracle\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-3-oracle\"}},[a._v(\"#\")]),a._v(\" 2.3 ORACLE\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v(\"SET TRANSACTION\\n...\\n\")])])]),s(\"h2\",{attrs:{id:\"_3-事务结束\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-事务结束\"}},[a._v(\"#\")]),a._v(\" 3. 事务结束\")]),a._v(\" \"),s(\"p\",[a._v(\"多数实现没有明确表示事务处理在何时结束，事务一直存在，知道被中断。\")]),a._v(\" \"),s(\"p\",[a._v(\"通常COMMIT 用于保存更改，ROLLBACK用于撤销\")]),a._v(\" \"),s(\"h3\",{attrs:{id:\"_3-1-rollback\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-1-rollback\"}},[a._v(\"#\")]),a._v(\" 3.1 ROLLBACK\")]),a._v(\" \"),s(\"p\",[a._v(\"SQL 的 ROLLBACK 命令用例回退（撤销）SQL 语句\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v(\"DELETE FROM ORDER；\\nROLLBACK;\\n\")])])]),s(\"h3\",{attrs:{id:\"_3-2-commit\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-2-commit\"}},[a._v(\"#\")]),a._v(\" 3.2 COMMIT\")]),a._v(\" \"),s(\"p\",[a._v(\"一般的SQL语句都是针对数据库表直接执行和编写的，这就是隐式提交（implicit commit）,既提交操作是自动进行的\")]),a._v(\" \"),s(\"h4\",{attrs:{id:\"_3-2-1-order\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-2-1-order\"}},[a._v(\"#\")]),a._v(\" 3.2.1 ORDER\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v(\"SET TRANSCTION\\nDELETE OrderItems WHERE order_num =12345;\\nDELETE Orders WHERE order_num = 1234;\\nCOMMIT;\\n\")])])]),s(\"h2\",{attrs:{id:\"_4-保留点\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-保留点\"}},[a._v(\"#\")]),a._v(\" 4.保留点\")]),a._v(\" \"),s(\"p\",[a._v(\"使用简单的ROLLBACK 和 COMMIT 语句，可以写入或者撤销整个事务。\")]),a._v(\" \"),s(\"p\",[a._v(\"但是，复杂的事务可能需要\"),s(\"strong\",[a._v(\"部分提交或者回退\")])]),a._v(\" \"),s(\"h3\",{attrs:{id:\"_4-1-是什么\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-1-是什么\"}},[a._v(\"#\")]),a._v(\" 4.1 是什么\")]),a._v(\" \"),s(\"p\",[a._v(\"要支持回退部分事务，必须在事务处理快中的合适位置\"),s(\"strong\",[a._v(\"放置占位符\")]),a._v(\"，这样如果需要回退，可以\"),s(\"strong\",[a._v(\"回退到某个占位符\")]),a._v(\"。这些占位符就是保留点\")]),a._v(\" \"),s(\"h3\",{attrs:{id:\"_4-2-mysql-oracle\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-2-mysql-oracle\"}},[a._v(\"#\")]),a._v(\" 4.2 MySQL,ORACLE\")]),a._v(\" \"),s(\"p\",[a._v(\"创建占位符\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v(\"SAVEPOINT delete1；\\n\")])])]),s(\"p\",[a._v(\"回退到占位符\")]),a._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[a._v(\"ROLLBACK TO delete1;\\n\")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);","extractedComments":[]}