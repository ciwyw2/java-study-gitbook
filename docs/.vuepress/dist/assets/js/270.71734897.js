(window.webpackJsonp=window.webpackJsonp||[]).push([[270],{1219:function(t,a,n){"use strict";n.r(a);var s=n(42),e=Object(s.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"hibernate实体类创建规则"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#hibernate实体类创建规则"}},[t._v("#")]),t._v(" Hibernate实体类创建规则")]),t._v(" "),n("h2",{attrs:{id:"_1-注意事项"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-注意事项"}},[t._v("#")]),t._v(" 1. 注意事项")]),t._v(" "),n("ol",[n("li",[t._v("为持久化类(实体类)提供无参构造")]),t._v(" "),n("li",[t._v("成员变量私有，提供get/set方法访问，需提供属性")]),t._v(" "),n("li",[t._v("持久化类中的属性应尽量用包装类型, 如Long 、String  因为基本类型不一定能用null")]),t._v(" "),n("li",[t._v("持久化类需提供唯一标志oid，与数据库中的主键列相对应")]),t._v(" "),n("li",[t._v("尽量不要用final修饰class。\n//因为hibernate使用cglib代理生成代理对象，代理对象是即成被代理对象的，final会导致无法代理")])]),t._v(" "),n("h2",{attrs:{id:"_2-主键"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-主键"}},[t._v("#")]),t._v(" 2. 主键")]),t._v(" "),n("h3",{attrs:{id:"_2-1-主键类型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-主键类型"}},[t._v("#")]),t._v(" 2.1 主键类型")]),t._v(" "),n("p",[t._v("自然主键(少见)和代理主键(常见)")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("1. 自然主键：表的业务列中，某列必须有且不重复时，该列可当作主键使用\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[t._v("代理主键：表的业务列中，没有某列必须有且不重复时，则需创建一个没有业务意义的列作为主键")])]),t._v(" "),n("h3",{attrs:{id:"_2-2-主键生成策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-主键生成策略"}},[t._v("#")]),t._v(" 2.2 主键生成策略")]),t._v(" "),n("p",[t._v("即每条记录录入时，主键的生成规则（位于orm元数据配置的id标签里的generator标签）")]),t._v(" "),n("ol",[n("li",[t._v("identity：主键自增：有数据库来维护主键值，录入时不需指定主")]),t._v(" "),n("li",[t._v("sequence：Oracle的主键生成策略")]),t._v(" "),n("li",[t._v("increment：主键自增：由hibernate来维护，每次插入时先查询表中id最大值，+1作为主键(线程不安全，不用)\n//此时执行save方法，为了生成id，会执行查询id最大值的sql语句")]),t._v(" "),n("li",[t._v("hilo(了解)：主键自增，高低位算法，有hibernate来维护（不使用）")]),t._v(" "),n("li",[n("strong",[t._v("native")]),t._v("：hilo+sequence+identity，自动三选一策略")]),t._v(" "),n("li",[n("strong",[t._v("uuid")]),t._v("：产生随机字符串作为主键。主键类型必须为String")]),t._v(" "),n("li",[t._v("assigned：自然主键生成策略，hibernate不管理主键值，由开发人员自己控制录入")])]),t._v(" "),n("h2",{attrs:{id:"_3-实体类注解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-实体类注解"}},[t._v("#")]),t._v(" 3. 实体类注解")]),t._v(" "),n("h3",{attrs:{id:"_3-1-id"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-id"}},[t._v("#")]),t._v(" 3.1 @Id")]),t._v(" "),n("p",[t._v("@Id 标注用于声明一个实体类的属性映射为"),n("a",{attrs:{href:"http://lib.csdn.net/base/mysql",target:"_blank",rel:"noopener noreferrer"}},[t._v("数据库"),n("OutboundLink")],1),t._v("的主键列。该属性通常置于属性声明语句之前，可与声明语句同行，也可写在单独行上。\n@Id标注也可置于属性的getter方法之前。")]),t._v(" "),n("h3",{attrs:{id:"_3-2-generatedvalue"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-generatedvalue"}},[t._v("#")]),t._v(" 3.2 @GeneratedValue")]),t._v(" "),n("p",[t._v("@GeneratedValue 用于标注主键的生成策略，通过strategy 属性指定。默认情况下，JPA 自动选择一个最适合底层数据库的主键生成策略：SqlServer对应identity，"),n("a",{attrs:{href:"http://lib.csdn.net/base/mysql",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL"),n("OutboundLink")],1),t._v(" 对应 auto increment。\n在javax.persistence.GenerationType中定义了以下几种可供选择的策略：")]),t._v(" "),n("ul",[n("li",[t._v("IDENTITY：采用数据库ID自增长的方式来自增主键字段，"),n("a",{attrs:{href:"http://lib.csdn.net/base/oracle",target:"_blank",rel:"noopener noreferrer"}},[t._v("Oracle"),n("OutboundLink")],1),t._v(" 不支持这种方式；")]),t._v(" "),n("li",[t._v("AUTO： JPA自动选择合适的策略，是默认选项；")]),t._v(" "),n("li",[t._v("SEQUENCE：通过序列产生主键，通过@SequenceGenerator 注解指定序列名，MySql不支持这种方式")]),t._v(" "),n("li",[t._v("TABLE：通过表产生主键，框架借由表模拟序列产生主键，使用该策略可以使应用更易于数据库移植。")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('\n@Table(name="CUSTOMERS")\n@Entity\npublic class Customer {\n    @GeneratedValue(strategy=GenerationType.AUTO)\n    @Id\n    private Integer id;\n    private String name;\n    private String email;\n    private int age;\n \n    public Integer getId() {\n        return id;\n    }\n    public void setId(Integer id) {\n        this.id = id;\n\n')])])]),n("h3",{attrs:{id:"_3-3-column"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-column"}},[t._v("#")]),t._v(" 3.3 @Column")]),t._v(" "),n("p",[t._v("当实体的属性与其映射的"),n("a",{attrs:{href:"http://lib.csdn.net/base/mysql",target:"_blank",rel:"noopener noreferrer"}},[t._v("数据库"),n("OutboundLink")],1),t._v("表的列不同名时需要使用@Column 标注说明，该属性通常置于实体的属性声明语句之前，还可与 @Id 标注一起使用。")]),t._v(" "),n("blockquote",[n("ul",[n("li",[t._v("@Column 标注的常用属性是name，用于设置映射数据库表的列名。此外，该标注还包含其它多个属性，如：unique、nullable、length 等。")]),t._v(" "),n("li",[t._v("@Column 标注的columnDefinition属性: 表示该字段在数据库中的实际类型.通常 ORM 框架可以根据属性类型自动判断数据库中字段的类型,但是对于Date类型仍无法确定数据库中字段类型究竟是DATE,TIME还是TIMESTAMP.此外,String的默认映射类型为VARCHAR,如果要将 String 类型映射到特定数据库的 BLOB 或TEXT字段类型.")])])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("name属性：\nname属性定义了被标注字段在数据库表中所对应字段的名称")])]),t._v(" "),n("li",[n("p",[t._v("unique属性：\nunique属性表示该字段是否为唯一标识，默认为false。\n如果表中有一个字段需要唯一标识，则既可以使用该标记，也可以使用@Table注解中的@UniqueConstraint")])]),t._v(" "),n("li",[n("p",[t._v("nullable属性：\nnullable属性表示该字段是否可以为null值，默认为true")])]),t._v(" "),n("li",[n("p",[t._v("insertable属性：\ninsertable属性表示在使用”INSERT”语句插入数据时，是否需要插入该字段的值")])]),t._v(" "),n("li",[n("p",[t._v("updateable属性：\nupdateable属性表示在使用”UPDATE”语句插入数据时，是否需要更新该字段的值")]),t._v(" "),n("p",[t._v("insertable和updateable属性一般多用于只读的属性，例如主键和外键等，这些字段通常是自动生成的\\")])]),t._v(" "),n("li",[n("p",[t._v("columnDefinition属性：\ncolumnDefinition属性表示创建表时，该字段创建的SQL语句，一般用于通过Entity生成表定义时使用\n如果数据库中表已经建好，该属性没有必要使用")])]),t._v(" "),n("li",[n("p",[t._v("table属性：\ntable属性定义了包含当前字段的表名")])]),t._v(" "),n("li",[n("p",[t._v("length属性：\nlength属性表示字段的长度，当字段的类型为varchar时，该属性才有效，默认为255个字符")])]),t._v(" "),n("li",[n("p",[t._v("precision属性和scale属性：\nprecision属性和scale属性一起表示精度，当字段类型为double时，precision表示数值的总长度，scale表示小数点所占的位数")])])]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Table")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CUSTOMERS"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Entity")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Customer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ID"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GeneratedValue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("strategy "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("GenerationType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AUTO"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Id")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Name"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Email"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nullable "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" length "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" email"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Age"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" age"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Remark"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" columnDefinition "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" remark"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Salary1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" columnDefinition "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"decimal(5,2)"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" salary1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Salary2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" precision "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" scale "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" salary2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Salary3"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" columnDefinition "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"decimal(5,2)"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BigDecimal")]),t._v(" salary3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Salary4"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" precision "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" scale "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BigDecimal")]),t._v(" salary4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),n("h2",{attrs:{id:"参考文章"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://sourceforge.net/projects/hibernate/files/hibernate-orm/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Hibernate"),n("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);